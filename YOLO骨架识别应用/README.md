# YOLO骨架识别应用

一个基于YOLOv8-pose的实时骨架识别应用，支持摄像头实时识别、录制功能和卡通形象绑定。

## 功能特性

### 🎯 核心功能
- **实时骨架识别**: 使用YOLOv8-pose模型进行实时人体姿态估计
- **录制功能**: 支持录制骨架数据，5秒延迟开始录制
- **卡通形象绑定**: 将检测到的骨架动作同步到卡通形象
- **多种卡通形象**: 支持火柴人、简单机器人、可爱角色三种卡通形象

### 🎮 交互控制
- **录制控制**: 按 'r' 键开始/停止录制
- **卡通形象**: 按 'c' 键切换卡通形象显示
- **骨架显示**: 按 's' 键切换骨架显示（增强版）
- **关键点显示**: 按 'k' 键切换关键点显示（增强版）
- **形象类型**: 按 't' 键切换卡通形象类型（增强版）
- **退出程序**: 按 'q' 键退出

## 文件结构

```
YOLO骨架识别应用/
├── skeleton_recording_app.py      # 基础版应用
├── enhanced_skeleton_app.py       # 增强版应用（推荐）
├── cartoon_character.py           # 卡通形象类
├── run_app.py                     # 应用启动器
├── requirements.txt               # 依赖包列表
└── README.md                      # 说明文档
```

## 安装和使用

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行应用

```bash
python run_app.py
```

或者直接运行特定版本：

```bash
# 运行基础版
python skeleton_recording_app.py

# 运行增强版（推荐）
python enhanced_skeleton_app.py
```

## 应用版本对比

### 基础版 (skeleton_recording_app.py)
- ✅ 实时骨架识别
- ✅ 录制功能（5秒延迟）
- ✅ 卡通形象绑定
- ✅ 基本UI显示

### 增强版 (enhanced_skeleton_app.py) - 推荐
- ✅ 实时骨架识别
- ✅ 录制功能（5秒延迟）
- ✅ 卡通形象绑定
- ✅ 完整UI控制
- ✅ 多种卡通形象类型
- ✅ 可切换骨架/关键点显示
- ✅ 实时FPS显示
- ✅ 详细状态信息

## 卡通形象类型

### 1. 火柴人 (stick_figure)
- 简洁的线条风格
- 清晰的关节连接
- 适合快速识别动作

### 2. 简单机器人 (simple_robot)
- 方形头部和身体
- 粗线条手臂和腿部
- 科技感十足

### 3. 可爱角色 (cute_character)
- 圆形头部和椭圆形身体
- 大眼睛和微笑
- 适合娱乐应用

## 录制数据格式

录制的数据以JSON格式保存，包含以下信息：

```json
[
  {
    "timestamp": 1234567890.123,
    "keypoints": [
      [
        [x1, y1, confidence1],
        [x2, y2, confidence2],
        ...
      ]
    ]
  }
]
```

- `timestamp`: 时间戳
- `keypoints`: 关键点数组，每个关键点包含 [x坐标, y坐标, 置信度]

## 技术细节

### 关键点定义 (COCO格式)
0. 鼻子
1. 左眼
2. 右眼
3. 左耳
4. 右耳
5. 左肩
6. 右肩
7. 左肘
8. 右肘
9. 左腕
10. 右腕
11. 左臀
12. 右臀
13. 左膝
14. 右膝
15. 左踝
16. 右踝

### 骨架连接
- 头部: 鼻子-眼睛-耳朵
- 躯干: 肩膀-手臂-手腕
- 腿部: 臀部-膝盖-脚踝

## 系统要求

- Python 3.7+
- OpenCV 4.5+
- PyTorch 1.9+
- Ultralytics 8.0+
- 摄像头设备

## 常见问题

### Q: 摄像头无法打开？
A: 检查摄像头是否被其他程序占用，或尝试更改摄像头索引。

### Q: 模型加载失败？
A: 确保网络连接正常，模型会自动下载。

### Q: 录制数据在哪里？
A: 录制数据保存在 `recordings/` 目录下，以JSON格式存储。

### Q: 如何调整检测精度？
A: 在代码中修改 `confidence_threshold` 参数，默认值为0.5。

## 开发说明

### 添加新的卡通形象类型

1. 在 `cartoon_character.py` 中添加新的绘制方法
2. 在 `get_character_types()` 中添加新类型
3. 在 `draw()` 方法中添加对应的调用

### 自定义录制功能

1. 修改 `recording_delay` 调整延迟时间
2. 在 `process_frame()` 中自定义录制逻辑
3. 修改 `save_recording_data()` 自定义保存格式

## 许可证

本项目基于MIT许可证开源。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目！

---

**注意**: 使用前请确保摄像头设备正常工作，建议在光线充足的环境下使用以获得最佳检测效果。
